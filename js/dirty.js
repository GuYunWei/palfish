(function(){function e(a,b,c){if(3===a.nodeType)a.nodeValue=lib.aa.template(a.nodeValue,b);else if(1===a.nodeType){var f=a.childNodes,d=a.getAttribute("data-repeat");a.removeAttribute("data-repeat");if(null!=d&&d in b){var d=b[d],h=a.parentNode;document.createElement("div").innerHTML=a.outerHTML;d instanceof Array?(d.forEach(function(b,c){var d=document.createElement("div");d.innerHTML=a.outerHTML;"[object Object]"==Object.prototype.toString.call(b)||b instanceof Array?b.__index__=c:b={__value__:b,
__index__:c};g(d,b);[].forEach.call(d.childNodes,function(b){h.insertBefore(b,a)})}),h.removeChild(a)):g(a,d)}[].forEach.call(a.attributes,function(a){a.value=lib.aa.template(a.value,b)});[].forEach.call(f,function(a){e(a,b)});c&&c(a)}}function i(a){var b;if(a.template_content)b=a.template_content;else{b=a.getAttribute("data-template");if(null!=b&&0<b.length){var c=lib.aa.$(b);if(c)b=c.innerHTML;else throw"[Dirty:setData]Cannot find html element : "+b;}else b=a.innerHTML;a.template_content=b}return b}
function g(a,b){var c=document.createElement("div");c.innerHTML=i(a);var f=c.querySelectorAll("[data-repeat]");if(b instanceof Array)if(f.length)b.forEach(function(a,b){"[object Object]"==Object.prototype.toString.call(a)||a instanceof Array?(a.__index__=b,e(c,a)):e(c,{__value__:a,__index__:b})});else{var d=[];b.forEach(function(a,b){"[object Object]"==Object.prototype.toString.call(a)||a instanceof Array?(a.__index__=b,d.push(lib.aa.template(c.innerHTML,a))):d.push(lib.aa.template(c.innerHTML,{__value__:a,
__index__:b}))});c.innerHTML=d.join("")}else f.length?e(c,b):c.innerHTML=lib.aa.template(c.innerHTML,b);a.innerHTML=c.innerHTML}Object.defineProperty(HTMLElement.prototype,"setData",{value:function(a){g(this,a)}})})();
